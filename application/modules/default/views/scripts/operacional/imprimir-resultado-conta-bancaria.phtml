<script language="javascript" type="text/javascript" src="<?php echo $this->baseUrl(); ?>/public/js/jquery-1.4.2.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        window.print();
    });
</script>

<style type="text/css" media="all">
    body {
        margin:0;
        font:12px "Trebuchet MS", Georgia, "Times New Roman", Times, serif;
        color:#000;
        line-height:14pt;
    }
    a:link, a:active, a:visited {
        text-decoration:underline;
    }
    a:hover {
        text-decoration:none;
    }
    .tabela { /* tamanho de tabelas com registros */
        margin:10px auto;
        width:97%;
        font:12px "Trebuchet MS", Georgia, "Times New Roman", Times, serif;
        border: 1px #999 solid;
        border-spacing: 1px;
        empty-cells: show;
    }
    table td {
        background:#fff;
        padding:4px;
        color:auto;
        font:12px "Trebuchet MS", Georgia, "Times New Roman", Times, serif;
        border: 1px #999 solid;
    }
    table tr.destacar td, table td.destacar {
        background:#e2e2e2;
        font:12px "Trebuchet MS", Georgia, "Times New Roman", Times, serif;
        border: 1px #999 solid;
    }
    table th {
        background:#cdcdcd;
        padding:4px;
        text-transform:uppercase;
        font-size:11px;
        border: 1px #999 solid;
        color: #000;
    }
    #brasao{
        width : 85px;
        height: 86px;
    }
    legend{
        font-size:13px;
        font-weight: bold;
    }
    .btn_imprimir{
        border-top:1px solid #efefef;
        border-left:1px solid #efefef;
        border-right:1px solid #aaa;
        border-bottom:1px solid #aaa;
        margin:0 5px 0 0;
        width:20px;
        height:21px;
        text-align:center;
        cursor:pointer;
        background:url('<?php echo $this->baseUrl(); ?>/public/img/buttons/imprimir.gif') center center no-repeat;
    }
    .btn_imprimir:hover{
        background-color:#fff;
        border-top:1px solid #aaa;
        border-left:1px solid #aaa;
        border-right:1px solid #efefef;
        border-bottom:1px solid #efefef;
    }
    .paginaA4{
        width:auto;
        margin: 1.111cm 1cm 1cm 1.005cm;
        page-break-after: always;
    }
    .TituloMinC{
        font-size: 14px;
        text-transform: uppercase;
    }
    .TituloDoDocumento{
        font-size: 12px;
        font-weight: bold;
        text-transform: uppercase;
    }
    .DataDoDocumento{
        font-size: 10px;
    }
    .QntdRegistros{
        font-size: 12px;
    }
</style>


<!-- ========== INÍCIO CONTEÚDO ========== -->
<div class="paginaA4">
    <div align="center">
        <img id="brasao" src="<?php echo $this->baseUrl(); ?>/public/img/brasaoArmas.jpg" alt="Ministério da Cidadania"/>
        <br clear="all" /><span class="TituloMinC">Ministério da Cultura</span>
        <br clear="all" /><span class="TituloDoDocumento">Conta Bancária - Resultado</span>
        <br clear="all" /><span class="DataDoDocumento">Data da impressão: <?php echo date('d/m/Y - H:i:s'); ?></span>
        <br clear="all" /><br clear="all" /><span class="QntdRegistros"><?php echo count($this->dados).' projetos listados'; ?></span>
    </div>

    <?php if($this->qtdRegistros > 0){ ?>
    <table class="tabela tablesorter">
        <thead>
            <tr class="titulo_tabela">
                <th>PRONAC</th>
                <th>Nome do Projeto</th>
                <th>Área</th>
                <th>Situação</th>
                <th>CNPJ/CPF</th>
                <th>Proponente</th>
                <th>Tipo de Pessoa</th>
                <th>N&ordm; Portaria</th>
                <th>Dt. Publicação Portaria</th>
                <th>Dt. Início Captação</th>
                <th>Dt. Fim Captação</th>
                <th>Dt. Nascimento</th>
                <th>Agência</th>
                <th>Conta Captação</th>
                <th>Conta Movimento</th>
                <th>Dt. Lote Remessa</th>
                <th>Ocorrência</th>
            </tr>
        </thead>
        <tbody>
            <?php foreach($this->dados as $d){ ?>
            <tr>
                <td align="center"><?php echo $d->Pronac; ?></td>
                <td><?php echo $d->NomeProjeto; ?></td>
                <td><?php echo $d->Area; ?></td>
                <td align="center"><?php echo $d->Situacao; ?></td>
                <td align="center"><?php echo (strlen($d->CgcCpf) > 11) ? Mascara::addMaskCNPJ($d->CgcCpf) : Mascara::addMaskCPF($d->CgcCpf); ?></td>
                <td><?php echo $d->Proponente; ?></td>
                <td><?php echo ($d->TipoPessoa == 1) ? 'Pessoa Jurídica' : 'Pessoa Física'; ?></td>
                <td><?php echo $d->NrPortaria; ?></td>
                <td align="center"><?php echo !empty($d->DtPublicacaoPortaria) ? Data::tratarDataZend($d->DtPublicacaoPortaria, 'Brasileira') : ''; ?></td>
                <td align="center"><?php echo !empty($d->DtInicioCaptacao) ? Data::tratarDataZend($d->DtInicioCaptacao, 'Brasileira') : ''; ?></td>
                <td align="center"><?php echo !empty($d->DtFimCaptacao) ? Data::tratarDataZend($d->DtFimCaptacao, 'Brasileira') : ''; ?></td>
                <td align="center"><?php echo !empty($d->DtNascimento) ? Data::tratarDataZend($d->DtNascimento, 'Brasileira') : ''; ?></td>
                <td><?php echo $d->Agencia; ?></td>
                <td>
                    <?php
                        if($d->TemCaptacao){
                            $string = $d->ContaCaptacao;
                            $size = strlen($string);
                            $numero = substr($string, 0, -1);
                            $digito = substr($string, $size - 1);
                            $numero = number_format($numero,0,'','.');
                            $numeroAgencia = $numero.'-'.$digito;
                            echo $numeroAgencia;
                        } else {
                            echo '';
                        }
                    ?>
                </td>
                <td>
                    <?php
                        if($d->ContaMovimento != '000000000000'){
                            $string = $d->ContaMovimento;
                            $size = strlen($string);
                            $numero = substr($string, 0, -1);
                            $digito = substr($string, $size - 1);
                            $numero = number_format($numero,0,'','.');
                            $numeroFormatado = $numero.'-'.$digito;
                            echo $numeroFormatado;
                        } else {
                            echo '';
                        }
                    ?>
                </td>
                <td align="center"><?php echo !empty($d->DtLoteRemessaCB) ? Data::tratarDataZend($d->DtLoteRemessaCB, 'Brasileira') : ''; ?></td>
                <td>
                    <?php
                        if($d->OcorrenciaCB != '000'){
                            switch ($d->OcorrenciaCB) {
                                case '001':
                                    echo 'Tipo de pessoa inválido';
                                    break;
                                case '002':
                                    echo 'Tipo de CPF/CNPJ inválido';
                                    break;
                                case '003':
                                    echo 'CPF/CNPJ inválido';
                                    break;
                                case '004':
                                    echo 'Data de nascimento inválida';
                                    break;
                                case '005':
                                    echo 'Nome cliente inválido';
                                    break;
                                case '006':
                                    echo 'Agência inválida';
                                    break;
                                case '007':
                                    echo 'Mais de 5 clientes cadastrado p/o CPF informado';
                                    break;
                                case '008':
                                    echo 'Cliente BB-Campus fora da faixa etária (16 a 28 anos)';
                                    break;
                                case '009':
                                    echo 'Cliente BB-Campus não titular do CPF';
                                    break;
                                case '010':
                                    echo 'Dados pessoa física divergentes';
                                    break;
                                case '011':
                                    echo 'Dados pessoa jurídica divergentes';
                                    break;
                                case '013':
                                    echo 'Cliente BB-Campus não  titular do CPF';
                                    break;
                                case '014':
                                    echo 'Perfil agência incompatível com tipo de pessoa';
                                    break;
                                case '015':
                                    echo 'Tipo de pessoa incompatível  com natureza jurídica';
                                    break;
                                case '016':
                                    echo 'Tipo de repasse inválido';
                                    break;
                                case '017':
                                    echo 'Tipo de pessoa não permitido para esse processo/tipo de repasse';
                                    break;
                                default:
                                    echo '';
                                    break;
                            }
                        } else {
                            echo '';
                        }
                    ?>
                </td>
            </tr>
            <?php } ?>
        </tbody>
    </table>

    <?php } else { ?>
    <table class="tabela">
        <tr>
            <td align="center">Nenhum registro encontrado.</td>
        </tr>
    </table>
    <?php } ?>
    <br clear="all" />
</div>

<!-- ========== INÍCIO RODAPÉ DO CONTEÚDO ========== -->
<div id="rodapeConteudo"><span></span></div>
<!-- ========== FIM RODAPÉ DO CONTEÚDO ========== -->

<br clear="all" />
