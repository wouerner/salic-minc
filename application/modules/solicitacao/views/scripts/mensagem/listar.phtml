<div class="table-responsive mensagens">
    <?php if (count($this->arrResult) > 0) : ?>
        <table class="table table-bordered" style="width: 100%">
            <thead class=" green darken-1 white-text">
            <tr>
                <th data-field="" class="messagem-numero left-align">Nº</th>
                <th data-field="" class="messagem-titulo left-align">Título</th>
                <!--                <th data-field="" class="left-align">Proponente</th>-->
                <th data-field="" class="mensagem-texto left-align">Solicita&ccedil;&atilde;o</th>
                <?php if (!$this->ehProponente)  : ?>
                    <th data-field="" class="left-align">T&eacute;cnico</th>
                <?php endif; ?>
                <th data-field="" class="mensagem-situacao left-align">Situa&ccedil;&atilde;o</th>
                <th data-field="id" class="mensagem-data center-align">Data</th>
            </tr>
            </thead>
            <tbody>
            <?php foreach ($this->arrResult as $int => $arrValue): ?>
                <?php
                $arrayUrl = ['module' => 'solicitacao', 'controller' => 'mensagem', 'action' => 'visualizar', 'id' => $arrValue['idSolicitacao']];

                if (!empty($arrValue['idPronac'])) {
                    $arrayUrl['idPronac'] = $arrValue['idPronac'];
                    $arrayProjeto = array('module' => 'default', 'controller' => 'consultardadosprojeto', 'action' => 'index', 'idPronac' => Seguranca::encrypt($arrValue['idPronac']));
                } elseif (!empty($arrValue['idProjeto'])) {
                    $arrayUrl['idPreProjeto'] = $arrValue['idProjeto'];
                    $arrayProjeto = array('module' => 'admissibilidade', 'controller' => 'admissibilidade', 'action' => 'exibirpropostacultural-ajax', 'idPreProjeto' => $arrValue['idProjeto']);
                }

                if ($arrValue['siEncaminhamento'] == 12) {
                    $arrayUrl['action'] = 'solicitar';
                    unset($arrayUrl['id']);
                }

                if ($arrValue['idTecnico'] == $this->idUsuario) {
                    $arrayUrl['action'] = 'responder';
                }
                ?>
                <tr class="<?= ($arrValue['stLeitura'] == 0 && !empty($arrValue['dtResposta'])) ? 'unread' : 'read'; ?>">
                    <td>
                        <?php if (!empty($arrValue['Pronac'])) : ?>
                            <a class="waves-effect waves-teal btn small white"
                               href="<?= $this->url($arrayProjeto, null, true); ?>"
                            ><?= $arrValue['Pronac']; ?></a>

                        <?php elseif ($arrValue['idProjeto']) : ?>
                            <a
                                data-ajax-modal="<?= $this->url($arrayProjeto); ?>"
                                href="javascript:void(0);"
                                data-position="top"
                                data-delay="50"
                                data-ajax-modal-height="96%"
                                data-ajax-modal-width="98%"
                                data-tooltip="Visualizar proposta"
                                class="waves-effect waves-teal btn small white tooltipped"
                            ><?= $arrValue['idProjeto']; ?></a>
                        <?php endif; ?>
                    </td>
                    <td>
                        <a href="<?php echo $this->url($arrayUrl, null, true); ?>">
                            <?= $arrValue['NomeProjeto']; ?>
                        </a>
                    </td>
                    <td>
                        <a href="<?php echo $this->url($arrayUrl, null, true); ?>">
                            <?= $arrValue['dsSolicitacao']; ?>
                        </a>
                    </td>
                    <?php if (!$this->ehProponente) : ?>
                        <td>
                            <a href="<?php echo $this->url($arrayUrl, null, true); ?>">
                                <?= $arrValue['Tecnico']; ?>
                            </a>
                        </td>
                    <?php endif; ?>
                    <td>
                        <a href="<?php echo $this->url($arrayUrl, null, true); ?>">
                            <?= $arrValue['dsEncaminhamento']; ?>
                        </a>
                    </td>
                    <td class="center-align"><?= date('d/m/Y', strtotime($arrValue['dtSolicitacao'])); ?></td>
                </tr>
            <?php endforeach; ?>
            </tbody>
        </table>
    <?php else: ?>
        <div class="padding20 green white-text">Sem solicita&ccedil;&otilde;es.</div>
    <?php endif; ?>
</div>
