<?php
$relatorio = $this->relatorioFiscalizacao;
$projeto = $this->projeto[0];
$dtInicioFiscalizacao = strtotime($this->relatorioFiscalizacao->dtInicioFiscalizacaoProjeto);
$dtDeCorte = strtotime(date('2013-09-15 00:00:00'));
?>

<?php $titulo = ($this->email) ? 'Comunicar Proponente da Fiscaliza&ccedil;&atilde;o' : 'Dados da Fiscaliza&ccedil;&atilde;o'; ?>

<div class="container-fluid">
    <?php $this->PageTitle($titulo, array(
        ['Fiscaliza&ccedil;&atilde;o do Projeto' => '/fiscalizacao/pesquisarprojetofiscalizacao/grid'],
        [$titulo => '']
    )); ?>
    <div id="conteudo">
        <?php if ($this->num == 2){ ?>
        <div class='conteudoImprimivel' id='conteudoImprimivel'>
            <?php } ?>

            <form
                action="<?php echo $this->url(array('controller' => 'pesquisarprojetofiscalizacao', 'action' => 'enviaremail')); ?>"
                id="frOficializar" method="post" enctype="multipart/form-data">
                <input type="hidden" name="idPronac" value="<?php echo $this->idPronac; ?>"/>
                <input type="hidden" name="idFiscalizacao" id="idFiscalizacao"
                       value="<?php echo $this->infoProjeto[0]->idFiscalizacao; ?>"/>
                <table class="tabela">
                    <tr>
                        <th colspan="2">Identifica&ccedil;&atilde;o</th>
                    </tr>
                    <tr>
                        <td class="destacar bold left-align" width="25%">PRONAC</td>
                        <td class="destacar bold left-align">NOME DO PROJETO</td>
                    </tr>
                    <tr>
                        <td class="left-align"><?php echo $this->infoProjeto[0]->AnoProjeto . $this->infoProjeto[0]->Sequencial; ?></td>
                        <td class="left-align"><?php echo $this->infoProjeto[0]->NomeProjeto; ?></td>
                    </tr>
                    <tr>
                        <td class="destacar bold left-align">CNPJ/CPF</td>
                        <td class="destacar bold left-align">NOME DO PROPONENTE</td>
                    </tr>
                    <tr>
                        <td class="left-align"><?php echo Validacao::mascaraCPFCNPJ($this->infoProjeto[0]->CgcCpf); ?></td>
                        <td class="left-align"><?php echo $this->infoProjeto[0]->Proponente; ?></td>
                    </tr>
                </table>

                <table class="tabela">
                    <tr>
                        <th colspan="2">Oficializar Fiscaliza&ccedil;&atilde;o</th>
                    </tr>
                    <tr>
                        <td class="destacar bold" align="right" width="200">Data In&iacute;cio</td>
                        <td><?php echo ($this->infoProjeto[0]->dtInicioFiscalizacaoProjeto != '') ? date('d/m/Y', strtotime($this->infoProjeto[0]->dtInicioFiscalizacaoProjeto)) : 'N&atilde;o informado'; ?></td>
                    </tr>
                    <tr>
                        <td class="destacar bold" align="right">Data Fim</td>
                        <td><?php echo ($this->infoProjeto[0]->dtFimFiscalizacaoProjeto != '') ? date('d/m/Y', strtotime($this->infoProjeto[0]->dtFimFiscalizacaoProjeto)) : 'N&atilde;o informado'; ?></td>
                    </tr>
                    <tr>
                        <td class="destacar bold" align="right">Demandante da Fiscaliza&ccedil;&atilde;o</td>
                        <td><?php echo ($this->infoProjeto[0]->tpDemandante == 0) ? 'SEFIC' : 'SAV'; ?></td>
                    </tr>
                    <tr>
                        <td class="destacar bold" align="right">Data de Resposta at&eacute;</td>
                        <td><?php if ($this->infoProjeto[0]->dtRespostaSolicitada != '') echo date('d/m/Y', strtotime($this->infoProjeto[0]->dtRespostaSolicitada)); ?></td>
                    </tr>
                    <tr>
                        <td class="destacar bold" align="right">CPF do T&eacute;cnico</td>
                        <td><?php echo Validacao::mascaraCPFCNPJ($this->infoProjeto[0]->cpfTecnico); ?></td>
                    </tr>
                    <tr>
                        <td class="destacar bold" align="right">Nome do T&eacute;cnico</td>
                        <td><?php echo $this->infoProjeto[0]->nmTecnico; ?></td>
                    </tr>
                    <tr>
                        <td class="destacar bold" align="right">Dados para Fiscaliza&ccedil;&atilde;o</td>
                        <td><?php echo !empty($this->infoProjeto[0]->dsFiscalizacaoProjeto) ? $this->infoProjeto[0]->dsFiscalizacaoProjeto : 'N&atilde;o informado'; ?></td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <table class="tabela">
                                <tr>
                                    <td class="destacar bold">&Oacute;rg&atilde;o</td>
                                    <td class="destacar bold">Observa&ccedil;&atilde;o</td>
                                </tr>
                                <?php if (is_object($this->dadosOrgaos)) foreach ($this->dadosOrgaos as $key => $value) { ?>
                                    <tr>
                                        <td><?php echo $value->Sigla; ?></td>
                                        <td><?php echo !empty($value->dsObservacao) ? $value->dsObservacao : 'N&atilde;o informado'; ?></td>
                                    </tr>
                                <?php } ?>

                                <?php if (count($this->dadosOrgaos) == 0) { ?>
                                    <tr>
                                        <td colspan="2" align="center">Nenhum registro encontrado</td>
                                    </tr>
                                <?php } ?>
                            </table>
                        </td>
                    </tr>
                </table>

                <?php $y = 1;
                if (!$this->email) {
                    if (count($relatorio)) { ?>
                        <table class="tabela">
                            <tr>
                                <th>Resumo da Execu&ccedil;&atilde;o</th>
                            </tr>
                            <tr>
                                <td class="destacar bold"><?php echo $y++ . '.'; ?> A&ccedil;&otilde;es Programadas</td>
                            </tr>
                            <tr>
                                <td>
                                    <?php if (isset($relatorio->dsAcoesProgramadas)) echo !empty($relatorio->dsAcoesProgramadas) ? $relatorio->dsAcoesProgramadas : 'N&atilde;o informado'; ?>
                                    <br clear="all"/><br clear="all"/>
                                </td>
                            </tr>
                            <tr>
                                <td class="destacar bold"><?php echo $y++ . '.'; ?> A&ccedil;&otilde;es Executadas</td>
                            </tr>
                            <tr>
                                <td>
                                    <?php if (isset($relatorio->dsAcoesExecutadas)) echo !empty($relatorio->dsAcoesExecutadas) ? $relatorio->dsAcoesExecutadas : 'N&atilde;o informado'; ?>
                                    <br clear="all"/><br clear="all"/>
                                </td>
                            </tr>
                            <tr>
                                <td class="destacar bold"><?php echo $y++ . '.'; ?> Benef&iacute;cios Alcan&ccedil;ados</td>
                            </tr>
                            <tr>
                                <td>
                                    <?php if (isset($relatorio->dsBeneficioAlcancado)) echo !empty($relatorio->dsBeneficioAlcancado) ? $relatorio->dsBeneficioAlcancado : 'N&atilde;o informado'; ?>
                                    <br clear="all"/><br clear="all"/>
                                </td>
                            </tr>
                            <tr>
                                <td class="destacar bold"><?php echo $y++ . '.'; ?> Dificuldades Encontradas</td>
                            </tr>
                            <tr>
                                <td>
                                    <?php if (isset($relatorio->dsDificuldadeEncontrada)) echo !empty($relatorio->dsDificuldadeEncontrada) ? $relatorio->dsDificuldadeEncontrada : 'N&atilde;o informado'; ?>
                                    <br clear="all"/><br clear="all"/>
                                </td>
                            </tr>
                        </table>

                        <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                            <table class="tabela">
                                <tr>
                                    <th colspan="2">Situa&ccedil;&atilde;o do Conv&ecirc;nio na Realiza&ccedil;&atilde;o da Fiscaliza&ccedil;&atilde;o</th>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Situa&ccedil;&atilde;o SIAFI</td>
                                    <td width="130"><?php if (isset($relatorio->stSiafi)) $selected = $relatorio->stSiafi; ?>
                                        <?php if ($selected == null) echo '--'; ?>
                                        <?php if ($selected == 0) echo 'N&atilde;o se aplica'; ?>
                                        <?php if ($selected == 1) echo 'Aprovado'; ?>
                                        <?php if ($selected == 2) echo 'A aprovar'; ?>
                                        <?php if ($selected == 3) echo 'A comprovar'; ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Presta&ccedil;&atilde;o de Contas Apresentada?</td>
                                    <td>
                                        <?php if (isset($relatorio->stPrestacaoContas)) $selected = $relatorio->stPrestacaoContas; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Foram cumpridas as normas estabelecidas?</td>
                                    <td>
                                        <?php if (isset($relatorio->stCumpridasNormas)) $selected = $relatorio->stCumpridasNormas; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Foi cumprido o prazo para entrega da presta&ccedil;&atilde;o de
                                        contas?
                                    </td>
                                    <td>
                                        <?php if (isset($relatorio->stCumpridoPrazo)) $selected = $relatorio->stCumpridoPrazo; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                            </table>
                        <?php } ?>

                        <table class="tabela">
                            <tr>
                                <th colspan="2">Utiliza&ccedil;&atilde;o de Recursos</th>
                            </tr>
                            <tr>
                                <td><?php echo $y++ . '.'; ?> Foi apurado por unidade fiscalizadora ou auditora a
                                    aplica&ccedil;&atilde;o irregular de recursos?
                                </td>
                                <td width="130">
                                    <?php if (isset($relatorio->stApuracaoUFiscalizacao)) $selected = $relatorio->stApuracaoUFiscalizacao; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>
                            <tr>
                                <td><?php echo $y++ . '.'; ?> Comprovou a correta utiliza&ccedil;&atilde;o dos recursos da
                                    contrapartida?
                                </td>
                                <td>
                                    <?php if (isset($relatorio->stComprovacaoUtilizacaoRecurso)) $selected = $relatorio->stComprovacaoUtilizacaoRecurso; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>
                            <tr>
                                <td><?php echo $y++ . '.'; ?>
                                    <?php if ($dtInicioFiscalizacao < $dtDeCorte){ ?>
                                    H&aacute; compatibilidade entre o desembolso e a evolu&ccedil;&atilde;o?
                                </td>
                                <?php } else { ?>
                                    H&aacute; compatibilidade entre os recursos transferidos e a evolu&ccedil;&atilde;o do projeto?</td>
                                <?php } ?>
                                <td>
                                    <?php if (isset($relatorio->stCompatibilidadeDesembolsoEvo)) $selected = $relatorio->stCompatibilidadeDesembolsoEvo; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>
                            <tr>
                                <td><?php echo $y++ . '.'; ?> Ocorreu despesas com multas, juros, taxas banc&aacute;rias
                                    ou corre&ccedil;&atilde;o monet&aacute;ria?
                                </td>
                                <td>
                                    <?php if (isset($relatorio->stOcorreuDespesas)) $selected = $relatorio->stOcorreuDespesas; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>

                            <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Ocorreu pagamento de servidor p&uacute;blico?</td>
                                    <td>
                                        <?php if (isset($relatorio->stPagamentoServidorPublico)) $selected = $relatorio->stPagamentoServidorPublico; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Ocorreu despesa com taxa de administra&ccedil;&atilde;o?</td>
                                    <td>
                                        <?php if (isset($relatorio->stDespesaAdministracao)) $selected = $relatorio->stDespesaAdministracao; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> H&aacute; transfer&ecirc;ncia de recurso para
                                        clubes/associa&ccedil;&otilde;es ou outras entidades cong&ecirc;neres?
                                    </td>
                                    <td>
                                        <?php if (isset($relatorio->stTransferenciaRecurso)) $selected = $relatorio->stTransferenciaRecurso; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> H&aacute; despesas com publicidade, salvo as de car&aacute;ter
                                        educativo, informativo ou de orienta&ccedil;&atilde;o social?
                                    </td>
                                    <td>
                                        <?php if (isset($relatorio->stDespesasPublicidade)) $selected = $relatorio->stDespesasPublicidade; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Ocorreu aditamento prevendo altera&ccedil;&atilde;o de
                                        objeto?
                                    </td>
                                    <td>
                                        <?php if (isset($relatorio->stOcorreuAditamento)) $selected = $relatorio->stOcorreuAditamento; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                            <?php } ?>


                            <tr>
                                <td>
                                    <?php echo $y++ . '.'; ?>
                                    <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                        N&atilde;o foram aplicados os recursos de contrapartida?
                                    <?php } else { ?>
                                        Os recursos de contrapartida foram depositados na conta do projeto?
                                    <?php } ?>
                                </td>
                                <td>
                                    <?php if (isset($relatorio->stAplicadosRecursos)) $selected = $relatorio->stAplicadosRecursos; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>

                                    <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    <?php } else { ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o h&aacute; contrapartida'; ?>
                                    <?php } ?>
                                </td>
                            </tr>
                            <tr>
                                <td><?php echo $y++ . '.'; ?> Ocorreu aplica&ccedil;&atilde;o de recursos em outra finalidade
                                    que n&atilde;o a do objeto pactuado?
                                </td>
                                <td>
                                    <?php if (isset($relatorio->stAplicacaoRecursosFinalidade)) $selected = $relatorio->stAplicacaoRecursosFinalidade; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>

                            <?php if ($dtInicioFiscalizacao > $dtDeCorte) { //Campo novo. S&oacute; aparece se o mesmo foi feito ap&oacute;s a data de corte. ?>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Os recursos captados est&atilde;o sendo aplicados em
                                        conformidade com a legisla&ccedil;&atilde;o vigente?
                                    </td>
                                    <td>
                                        <?php if (isset($relatorio->stRecursosCaptados)) $selected = $relatorio->stRecursosCaptados; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                            <?php } ?>

                            <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Ocorreu saldo ap&oacute;s o encerramento do projeto?</td>
                                    <td>
                                        <?php if (isset($relatorio->stSaldoAposEncerramento)) $selected = $relatorio->stSaldoAposEncerramento; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> O saldo verificado foi recolhido ao FNC?</td>
                                    <td>
                                        <?php if (isset($relatorio->stSaldoVerificacaoFNC)) $selected = $relatorio->stSaldoVerificacaoFNC; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                            <?php } ?>
                        </table>

                        <table class="tabela">
                            <tr>
                                <th colspan="2">Comprovantes Fiscais de Despesa</th>
                            </tr>
                            <tr>
                                <td><?php echo $y++ . '.'; ?>
                                    <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                        O processo est&aacute; bem documentado?
                                    <?php } else { ?>
                                        O proponente/convenente tem mantido a documenta&ccedil;&atilde;o relativa ao projeto em arquivo pr&oacute;prio?
                                    <?php } ?>
                                </td>
                                <td width="130">
                                    <?php if (isset($relatorio->stProcessoDocumentado)) $selected = $relatorio->stProcessoDocumentado; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>

                            <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> A documenta&ccedil;&atilde;o est&aacute; completa e
                                        arquivada?
                                    </td>
                                    <td>
                                        <?php if (isset($relatorio->stDocumentacaoCompleta)) $selected = $relatorio->stDocumentacaoCompleta; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                            <?php } ?>

                            <tr>
                                <td><?php echo $y++ . '.'; ?> Guardam conformidade entre o executado e o aprovado?</td>
                                <td>
                                    <?php if (isset($relatorio->stConformidadeExecucao)) $selected = $relatorio->stConformidadeExecucao; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>
                            <tr>
                                <td><?php echo $y++ . '.'; ?>
                                    <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                        Identificam o nome do projeto e o n&uacute;mero do conv&ecirc;nio?
                                    <?php } else { ?>
                                        Identificam o projeto com o n&uacute;mero do Pronac/Conv&ecirc;nio?
                                    <?php } ?>
                                </td>
                                <td>
                                    <?php if (isset($relatorio->stIdentificaProjeto)) $selected = $relatorio->stIdentificaProjeto; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>
                            <tr>
                                <td><?php echo $y++ . '.'; ?> Existem despesas anteriores ao prazo de vig&ecirc;ncia?
                                </td>
                                <td>
                                    <?php if (isset($relatorio->stDespesaAnterior)) $selected = $relatorio->stDespesaAnterior; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>

                            <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Existem despesas posteriores ao prazo de vig&ecirc;ncia?</td>
                                    <td>
                                        <?php if (isset($relatorio->stDespesaPosterior)) $selected = $relatorio->stDespesaPosterior; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                            <?php } ?>

                            <tr>
                                <td><?php echo $y++ . '.'; ?> As despesas coincidem com as informadas na rela&ccedil;&atilde;o
                                    de pagamentos?
                                </td>
                                <td>
                                    <?php if (isset($relatorio->stDespesaCoincidem)) $selected = $relatorio->stDespesaCoincidem; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>
                            <tr>
                                <td><?php echo $y++ . '.'; ?> As despesas est&atilde;o devidamente relacionadas no
                                    extrato banc&aacute;rio?
                                </td>
                                <td>
                                    <?php if (isset($relatorio->stDespesaRelacionada)) $selected = $relatorio->stDespesaRelacionada; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>
                            <tr>
                                <td><?php echo $y++ . '.'; ?> Os comprovantes fiscais est&atilde;o com o atesto do
                                    recebimento?
                                </td>
                                <td>
                                    <?php if (isset($relatorio->stComprovanteFiscal)) $selected = $relatorio->stComprovanteFiscal; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>
                        </table>

                        <table class="tabela">
                            <tr>
                                <th colspan="2">Divulga&ccedil;&atilde;o</th>
                            </tr>

                            <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Ci&ecirc;ncia ao Poder legislativo?</td>
                                    <td width="130">
                                        <?php if (isset($relatorio->stCienciaLegislativo)) $selected = $relatorio->stCienciaLegislativo; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                            <?php } ?>

                            <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Contemplou as exig&ecirc;ncias legais?</td>
                                    <td width="130">
                                        <?php if (isset($relatorio->stExigenciaLegal)) $selected = $relatorio->stExigenciaLegal; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> H&aacute; material informativo do Projeto?</td>
                                    <td>
                                        <?php if (isset($relatorio->stMaterialInformativo)) $selected = $relatorio->stMaterialInformativo; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                            <?php } else { ?>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> H&aacute; material informativo do Projeto?</td>
                                    <td>
                                        <?php if (isset($relatorio->stMaterialInformativo)) $selected = $relatorio->stMaterialInformativo; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Contemplou as exig&ecirc;ncias legais?</td>
                                    <td width="130">
                                        <?php if (isset($relatorio->stExigenciaLegal)) $selected = $relatorio->stExigenciaLegal; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                            <?php } ?>
                        </table>

                        <table class="tabela">
                            <tr>
                                <th colspan="2">Execu&ccedil;&atilde;o</th>
                            </tr>

                            <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> Alcan&ccedil;ou a finalidade esperada?</td>
                                    <td width="130">
                                        <?php if (isset($relatorio->stFinalidadeEsperada)) $selected = $relatorio->stFinalidadeEsperada; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                                <tr>
                                    <td><?php echo $y++ . '.'; ?> As metas/etapas do Plano de Trabalho foram executadas
                                        integralmente?
                                    </td>
                                    <td>
                                        <?php if (isset($relatorio->stPlanoTrabalho)) $selected = $relatorio->stPlanoTrabalho; ?>
                                        <?php if ($selected == null) echo '--' ?>
                                        <?php if ($selected == 1) echo 'Sim'; ?>
                                        <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                        <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                    </td>
                                </tr>
                            <?php } ?>

                            <tr>
                                <td>
                                    <?php echo $y++ . '.'; ?>
                                    <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                        A execu&ccedil;&atilde;o respeitou o aprovado?
                                    <?php } else { ?>
                                        O projeto est&aacute; sendo executado de acordo com o aprovado?
                                    <?php } ?>
                                </td>
                                <td width="130">
                                    <?php if (isset($relatorio->stExecucaoAprovado)) $selected = $relatorio->stExecucaoAprovado; ?>
                                    <?php if ($selected == null) echo '--' ?>
                                    <?php if ($selected == 1) echo 'Sim'; ?>
                                    <?php if ($selected == 2) echo 'N&atilde;o'; ?>
                                    <?php if ($selected == 3) echo 'N&atilde;o se aplica'; ?>
                                </td>
                            </tr>

                            <?php if ($dtInicioFiscalizacao > $dtDeCorte) { //Campo novo. S&oacute; aparece se o mesmo foi feito ap&oacute;s a data de corte. ?>
                                <tr>
                                    <td colspan="2" class="destacar"><?php echo $y++ . '.'; ?>
                                        Observa&ccedil;&otilde;es
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <?php echo $relatorio->dsObservacao; ?>
                                    </td>
                                </tr>
                            <?php } ?>
                        </table>

                        <table class="tabela">
                            <tr>
                                <th colspan="3">Empregos gerados em decorr&ecirc;ncia do projeto</th>
                            </tr>
                            <tr>
                                <td><?php echo $y++ . '.'; ?>
                                    Diretos: <?php if (isset($relatorio->qtEmpregoDireto)) echo $relatorio->qtEmpregoDireto; ?></td>
                                <td><?php echo $y++ . '.'; ?>
                                    Indiretos: <?php if (isset($relatorio->qtEmpregoIndireto)) echo $relatorio->qtEmpregoIndireto; ?></td>
                                <td><?php echo $y++ . '.'; ?> Total:
                                    <?php if (isset($relatorio->qtEmpregoDireto)) {
                                        if (isset($relatorio->qtEmpregoIndireto)) {
                                            echo $relatorio->qtEmpregoDireto + $relatorio->qtEmpregoIndireto;
                                        } else {
                                            echo $relatorio->qtEmpregoDireto;
                                        }
                                    } else {
                                        if (isset($relatorio->qtEmpregoDireto)) {
                                            echo $relatorio->qtEmpregoDireto;
                                        } else {
                                            echo "--";
                                        }
                                    }
                                    ?>
                                </td>
                            </tr>
                        </table>

                        <table class="tabela">
                            <tr>
                                <td class="destacar bold"><?php echo $y++ . '.'; ?> Evid&ecirc;ncias</td>
                            </tr>
                            <tr>
                                <td>
                                    <?php if (isset($relatorio->dsEvidencia)) echo !empty($relatorio->dsEvidencia) ? $relatorio->dsEvidencia : 'N&atilde;o informado'; ?>
                                    <br clear="all"/><br clear="all"/>
                                </td>
                            </tr>
                            <tr>
                                <td class="destacar bold"><?php echo $y++ . '.'; ?> Recomenda&ccedil;&otilde;es da Equipe</td>
                            </tr>
                            <tr>
                                <td>
                                    <?php if (isset($relatorio->dsRecomendacaoEquipe)) echo !empty($relatorio->dsRecomendacaoEquipe) ? $relatorio->dsRecomendacaoEquipe : 'N&atilde;o informado'; ?>
                                    <br clear="all"/><br clear="all"/>
                                </td>
                            </tr>

                            <?php if ($dtInicioFiscalizacao < $dtDeCorte) { ?>
                                <tr>
                                    <td class="destacar bold"><?php echo $y++ . '.'; ?> Conclus&atilde;o da Equipe</td>
                                </tr>
                                <tr>
                                    <td>
                                        <?php if (isset($relatorio->dsConclusaoEquipe)) echo !empty($relatorio->dsConclusaoEquipe) ? $relatorio->dsConclusaoEquipe : 'N&atilde;o informado'; ?>
                                        <br clear="all"/><br clear="all"/>
                                    </td>
                                </tr>
                            <?php } ?>

                            <tr>
                                <td class="destacar bold"><?php echo $y++ . '.'; ?> Parecer da Fiscaliza&ccedil;&atilde;o</td>
                            </tr>
                            <tr>
                                <td>
                                    <?php if (isset($relatorio->dsParecerTecnico)) echo !empty($relatorio->dsParecerTecnico) ? $relatorio->dsParecerTecnico : 'N&atilde;o informado'; ?>
                                    <br clear="all"/><br clear="all"/>
                                </td>
                            </tr>

                            <?php if ($this->isCoordenador) { // coordenador  ?>
                                <tr>
                                    <td class="destacar bold"><?php echo $y++ . '.'; ?> Parecer do Coordenador</td>
                                </tr>
                                <tr>
                                    <td>
                                        <?php if (isset($relatorio->dsParecer)) echo !empty($relatorio->dsParecer) ? $relatorio->dsParecer : 'N&atilde;o informado'; ?>
                                        <br clear="all"/><br clear="all"/>
                                    </td>
                                </tr>
                            <?php } ?>
                        </table>

                        <br clear="all"/>

                        <table class="tabela">
                            <tr>
                                <th>Anexos</th>
                            </tr>
                            <?php if (count($this->arquivos)) {
                                foreach ($this->arquivos as $arquivo) { ?>
                                    <tr>
                                        <td>
                                            <a href='<?php echo $this->url(array("module" => "default", "controller" => "upload", "action" => "abrir")) . '?id=' . $arquivo->idArquivo; ?>'><?php echo $arquivo->nmArquivo; ?></a>
                                        </td>
                                    </tr>
                                <?php }
                            } else { ?>
                                <tr>
                                    <td style="color:red;">N&atilde;o h&aacute; arquivos anexados!</td>
                                </tr>
                            <?php } ?>
                        </table>

                    <?php } else { ?>
                        <div align="center">
                            <table class="tabela">
                                <tr>
                                    <th>Aguardando Fiscaliza&ccedil;&atilde;o</th>
                                </tr>
                            </table>
                        </div>
                    <?php } ?>



                <?php } ?>


                <?php if ($this->email) { ?>
                    <p align="center"><input type="button" class="btn_enviar" name="enviar" value=""/></p>
                <?php } ?>

            </form>

            <?php if ($this->num == 2){ ?>
        </div>
    <?php } ?>

        <?php /*if($this->num == 2){ ?>
    <table class="tabela">
        <tr>
            <td colspan="14" align="center"><input type="button" class="btn_imprimir" onclick="$('#conteudoImprimir').val($('.conteudoImprimivel').html()); $('#formGerarPdf').submit();"/></td>
        </tr>
    </table>
    <?php }*/ ?>
        <?php if ($this->infoProjeto[0]->stFiscalizacaoProjeto == 3) { ?>
            <p align="center"><input type="button" name="btn_imprimir" id="btn_imprimir" class="btn_imprimir"></p>
        <?php } ?>
        <br clear="all"/>
    </div>
</div>

<script type="text/javascript">
    $(function () {
        mascaras('#frOficializar');
        $('.btn_enviar').click(function () {
            var nomeJanelaAlerta = janelaObj({
                parametros: {
                    width: 400,
                    autoOpen: false,
                    resizable: false,
                    modal: true,
                    buttons: {
                        'N\u00e3o': function () {
                            $(this).dialog('close');
                        },
                        Sim: function () {
                            $('#frOficializar').submit();
                            $(this).dialog('close');
                        }
                    }
                },
                removerBtFechar: true,
                title: 'Alerta'
            });
            nomeJanelaAlerta.divConteudo.html('Deseja enviar email para o proponente?');
            nomeJanelaAlerta.abrirJanela();
        });
        $('#indicarSim').click(function () {
            if ($(this).attr('checked')) {
                $('#parecerista').css('display', '');
                $('#CNPJCPF').attr('null', 'false');
                $('#Descricao').attr('null', 'false');
                $('#CNPJCPF').attr('cnpjcpf', 'true');
            }
        });
        $('#indicarNao').click(function () {
            if ($(this).attr('checked')) {
                $('#parecerista').css('display', 'none');
                $('#CNPJCPF').attr('null', '');
                $('#Descricao').attr('null', '');
                $('#CNPJCPF').attr('cnpjcpf', '');
                $('#CNPJCPF').val('');
                $('#Descricao').val('');
                $('#idAgente').val('');
            }
        });

        $('#addAnexo').click(function () {
            var divAnexos = $('#divAnexos');
            var div = $('<div></div>').css('marginLeft', '200px').appendTo(divAnexos);
            var file = $('<input />').attr('type', 'file').attr('name', 'arquivo[]').addClass('input_simples').appendTo(div);
            var excluir = $('<input />').attr('type', 'button').addClass('btn_excluir').click(function () {
                div.remove();
            }).appendTo(div);

        });
        $('#addOrgao').click(function () {

            var tbOrgao = $('#tbOrgao');
            var orgAdd = $('#orgao').val();
            var proceguir = true;
            $(tbOrgao).find('.inpOrg').each(function () {
                if (orgAdd == $(this).val())
                    proceguir = false;
            });
            if (proceguir && orgAdd != '') {
                var tr = $('<tr></tr>').appendTo(tbOrgao);
                var texto = '';
                $('#orgao').find('option').each(function () {
                    if (orgAdd == $(this).val())
                        texto = $(this).html();
                });
                var td1 = $('<td></td>').html(texto).appendTo(tr);
                var td2 = $('<td></td>').appendTo(tr);
                var hidden = $('<input />').attr('type', 'hidden').addClass('inpOrg').attr('name', 'idOrgao[]').val(orgAdd).appendTo(td2);
                var excluir = $('<input />').attr('type', 'button').addClass('btn_excluir').click(function () {
                    tr.remove();
                }).appendTo(td2);
            }
        });

        //    $('#frOficializar').submit(function(){
        //       return validarFormulario('#frOficializar','Preecher campos obrigatorios!');
        //    });

        $('.btn_imprimir').click(function () {
            window.open('<?php echo $this->url(array('controller' => 'pesquisarprojetofiscalizacao', 'action' => 'imprimir')); ?>?idPronac=<?php echo $this->infoProjeto[0]->IdPRONAC; ?>&idFiscalizacao=<?php echo $this->infoProjeto[0]->idFiscalizacao; ?>');
        });

        $('.btn_excluir').click(function () {
            var este = this;
            var nomeJanelaAlerta = janelaObj({
                parametros: {
                    width: 400,
                    autoOpen: false,
                    resizable: false,
                    modal: true,
                    buttons: {
                        'N\u00e3o': function () {
                            $(this).dialog('close');
                        },
                        Sim: function () {

                            var resp;
                            if ($(este).attr('idOrgaoFiscalizador') != undefined) {
                                resp = buscarJson('<?php echo $this->url(array('controller' => 'pesquisarprojetofiscalizacao', 'action' => 'excluir')); ?>', { idOrgaoFiscalizador: $(este).attr('idOrgaoFiscalizador') });
                            }
                            if ($(este).attr('idArquivoFiscalizacao') != undefined && $(este).attr('idArquivo') != undefined) {
                                resp = buscarJson('<?php echo $this->url(array('controller' => 'pesquisarprojetofiscalizacao', 'action' => 'excluir')); ?>', {
                                    idArquivoFiscalizacao: $(este).attr('idArquivoFiscalizacao'),
                                    idArquivo: $(este).attr('idArquivo')
                                });
                            }
                            if (resp.result) {
                                $(este).parent().parent().remove();
                            }
                            janelaAlerta(resp.mensagem);

                            $(this).dialog('close');
                        }
                    }
                },
                removerBtFechar: true,
                title: 'Alerta'
            });
            nomeJanelaAlerta.divConteudo.html('Deseja excluir?');
            nomeJanelaAlerta.abrirJanela();
        });

    });

    function requisicaoAjaxObj() {
        var ajaxObj = {
            pagina: '',
            parametros: {},
            type: 'post',
            dataType: '',
            resposta: '#conteudo',
            async: true,
            funcaoRetorno: function (resposta) {
                $(this.resposta).html(resposta);
            },
            executar: function (dados) {
                this.refineParametrosObj(dados);
                var esteObj = this;
                if (this.resposta != undefined && this.resposta != '')
                    $(this.resposta).html('<img src="<?php echo $this->baseUrl(); ?>/public/img/ajax.gif" alt="carregando"><br/><br/>Carregando...<br>Por Favor, aguarde!!');
                $.ajax({
                    type: esteObj.type,
                    url: esteObj.pagina,
                    data: esteObj.parametros,
                    async: esteObj.async,
                    success: function (resp) {
                        esteObj.funcaoRetorno(resp);
                    }
                    , dataType: esteObj.dataType
                });
            },
            refineParametrosObj: function (data) {
                if (data != undefined)
                    for (var j in data) {

                        this[j] = data[j];
                    }
            }
        }
        return ajaxObj;
    }

    function buscarJson(pagina, dados) {
        var retorno = '';
        var select = requisicaoAjaxObj();
        select.executar({
            pagina: pagina,
            parametros: dados,
            resposta: undefined,
            async: false,
            funcaoRetorno: function (resposta) {
                //alert(resposta);
                retorno = resposta;
            }
            , dataType: 'json'
        });
        return retorno;
    }

    function mascaras(form) {
        $('input[type!=submit]|[type!=button]').addClass('input_simples');
        $('textarea').addClass('textarea_simples');
        $('select[id!=perfilXgrupo]').addClass('select_simples');
        $(form).find('[data=true]').each(function () {
            $(this).keyup(function () {
                mascara(this, format_data);
                var este = this;
                setTimeout(function () {
                    $(este).val($(este).val().substr(0, 10));
                }, 2);
            });
            $(this).datepicker({
                showOn: 'button',
                buttonImage: '<?php echo $this->baseUrl(); ?>/public/img/ico/calendar.gif',
                buttonImageOnly: true,
                dateFormat: 'dd/mm/yy'
            });
        });
        $(form).find('[sonumero=true]').keyup(function () {
            mascara(this, format_num);
        });
        $(form).find('[dinheiro=true]').keyup(function () {
            mascara(this, format_moeda);
        });

        $(form).find('[cnpjcpf=true]').each(function () {
            var este = this;
            $('.' + $(este).attr('classaux')).click(function () {
                mascaraCNPJCPF(este);
                buscarFornecedor(este);
            });
        });
        $(form).find('[cnpjcpf=true]').keyup(function () {
            mascaraCNPJCPF(this);
            buscarFornecedor(this);
        });
    }

    function buscarFornecedor(este) {
        if ($(este).attr('idAgente') != undefined && $(este).attr('idAgente') && $(este).attr('idDescricao') != undefined && $(este).attr('idDescricao')) {
            if ($(este).val().length == 14) {
                var fornecedor = buscarJson('<?php echo $this->url(array('controller' => 'pesquisarprojetofiscalizacao', 'action' => 'buscartecnico')); ?>', { cnpjcpf: $(este).val() });
                if (fornecedor.retorno) {
                    $('#' + $(este).attr('idAgente')).val(fornecedor.idAgente);
                    $('#' + $(este).attr('idDescricao')).val(fornecedor.descricao).attr('readonly', true);
                }
                else {
                    $('#' + $(este).attr('idAgente')).val('');
                    $('#' + $(este).attr('idDescricao')).val('').attr('readonly', false);
                }
            }
            else {
                $('#' + $(este).attr('idAgente')).val('');
                $('#' + $(este).attr('idDescricao')).val('').attr('readonly', false);
            }
        }
    }

    function buscarRadioMarcado(este) {
        var marcado = '';
        $('.' + $(este).attr('classaux')).each(function () {
            if ($(this).attr('checked')) {
                marcado = $(this).val();
            }
        });
        return marcado;
    }

    function mascaraCNPJCPF(este) {
        var marcado = 'cpf';//buscarRadioMarcado(este);
        switch (marcado) {
            case 'cpf':
                $(este).val($(este).val().slice(0, 14));
                $(este).attr('maxlength', 14);
                mascara(este, format_cpf);
                break;
            case 'cnpj':
                $(este).attr('maxlength', 18);
                mascara(este, format_cnpj);
                break;
            default:
                janelaAlerta('Selecione o Tipo do Fornecedor');
                $(este).val('');
        }
    }

    function validarFormulario(form, mensagem) {
        var validar = false;
        if (mensagem == undefined) {
            mensagem = '';
        }

        $(form).find('[cnpjcpf=true]').each(function () {
            var este = this;
            var marcado = 'cpf';//buscarRadioMarcado(este);
            if (marcado == 'cpf' && $(este).val().length < 14) {
                validar = true;
                mensagem += '<br />Preencha o CPF.';
            }
            if (marcado == 'cnpj' && $(este).val().length < 18) {
                validar = true;
                mensagem += '<br />Preencha o CNPJ.';
            }
        });


        $(form).find('[data=true]').each(function () {
            var estadata = $(this).val().slice(6, 10) + '' + $(this).val().slice(3, 5) + '' + $(this).val().slice(0, 2);
            if ($(this).attr('menorque') != undefined) {
                var menorid = '#' + $(this).attr('menorque');
                if ($(menorid).val() != '') {
                    var menordata = $(menorid).val().slice(6, 10) + '' + $(menorid).val().slice(3, 5) + '' + $(menorid).val().slice(0, 2);
                    if (estadata > menordata) {
                        validar = true;
                        mensagem += '<br />A "' + $(this).attr('title') + '" deve ser menor que a "' + $(menorid).attr('title') + '"';
                    }
                }
            }
            if ($(this).attr('maiorque') != undefined) {
                var maiorid = '#' + $(this).attr('maiorque');
                if ($(maiorid).val() != '') {
                    var maiordata = $(maiorid).val().slice(6, 10) + '' + $(maiorid).val().slice(3, 5) + '' + $(maiorid).val().slice(0, 2);
                    if (estadata < maiordata) {
                        validar = true;
                        mensagem += '<br />A "' + $(this).attr('title') + '" deve ser maior que a "' + $(maiorid).attr('title') + '"';
                    }
                }
            }
        });
        $(form).find('[null=false]').each(function () {
            if ($(this).attr('type') == 'radio') {
                var validaRadio = true;
                $(form + ' [name=' + $(this).attr('name') + ']').each(function () {
                    if ($(this).attr('checked'))
                        validaRadio = false;
                });
                if (validaRadio)
                    validar = true;
            } else {
                if ($.trim($(this).val()).length == 0)
                    validar = true;
            }
            //        if(validar)
            //            alert($(this).attr('name'));
        });

        if (validar) {
            janelaAlerta(mensagem);
            return false;
        }
        else
            return true;
    }

    function janelaAlerta(mensagem, funcaoAdcional) {
        if (funcaoAdcional == undefined) {
            funcaoAdcional = function () {
            }
        }
        var nomeJanelaAlerta = janelaObj({
            parametros: {
                width: 400,
                autoOpen: false,
                resizable: false,
                modal: true,
                buttons: {
                    OK: function () {
                        funcaoAdcional();
                        $(this).dialog('close');
                    }
                }
            },
            removerBtFechar: true,
            title: 'Alerta'
        });
        nomeJanelaAlerta.divConteudo.html(mensagem);
        nomeJanelaAlerta.abrirJanela();

        return nomeJanelaAlerta;
    }

    function janelaObj(dados) {
        var divConteudo = $('<div></div>')
            .attr('title', dados.title)
            .appendTo('body');
        var novaJanela = {
            divConteudo: divConteudo,
            removerBtFechar: true,
            parametros: { autoOpen: false },
            iniciarJanela: function (dados) {
                this.refineParametrosObj(dados);

                this.divConteudo.dialog(this.parametros);
            },
            abrirJanela: function () {
                this.divConteudo.dialog('open');
                if (this.removerBtFechar)
                    $('.ui-dialog-titlebar-close').remove();
            },
            fecharJanela: function () {
                this.divConteudo.dialog('close');
                this.divConteudo.remove();
            },
            refineParametrosObj: function (data) {
                if (data != undefined)
                    for (var j in data) {
                        this[j] = data[j];
                    }
            }
        }
        novaJanela.iniciarJanela(dados);
        return novaJanela;
    }
</script>
