<?php
include_once 'scripts/alterarprojeto/inc/menu.inc.php';
?>

<!-- ========== INÍCIO BREADCRUMB (LINKS TOPO) ========== -->
<div id="breadcrumb">
    <ul>
        <li class="first"><a href="<?php echo $this->url(array('controller' => 'principal', 'action' => '')); ?>" title="Ir para p&aacute;gina inicial">Início</a></li>
        <li><!--a href="<?php echo $this->baseUrl(); ?>" title="Início"-->Manuten&ccedil;&atilde;o<!--/a--></li>
        <li><a href="<?php echo $this->url(array('controller' => 'alterarprojeto', 'action' => 'consultarprojeto')); ?>" title="Ir para alterar projeto">Alterar projeto</a></li>
        <li class="last">Alterar plano de distribui&ccedil;&atilde;o</li>
    </ul>
</div>
<!-- ========== FIM BREADCRUMB (LINKS TOPO) ========== -->


<!-- ========== BUTTON VOLTAR ========== -->
<div id="titulo">
    <div>Alterar plano de distribui&ccedil;&atilde;o<span class="voltar"><a href="javascript:voltar();" title="Ir para p&aacute;gina anterior">Voltar</a></span></div>
</div>
<!-- ========== FIM TÍTULO ========== -->

<script type="text/javascript">
    $(document).ready(function(){

        <?php if(isset($this->movimentacaoAtual) && $this->movimentacaoAtual != '95'): ?>
             //DESABILITA ALTERACOES NOS DADOS DO FORMULARIO (INCLUIR/ALTERAR/EXCLUIR)
             JSBloquearAlteracaoFormulario();
        <?php endif; ?>
        	
        //CARREGAR COMBO DE SEGMENTOS DE ACORDO COM A COMBO DE AREAS
	<?php foreach ($this->planoDistribuicao as $planoDistribuicao): ?>
        <?php if(!empty($planoDistribuicao->Area)): ?>

	$("#patrocinador-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").numeric();
        $("#divulgacao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").numeric();
        $("#beneficiarios-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").numeric();
        $("#qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").numeric();
        $("#qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").numeric();
        $("#preconormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").priceFormat();
        $("#precopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").priceFormat();
	
        // carrega a combo de segmentos culturais
        $('#areaCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').change(function() {
            $('#segmentoCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').html('<option value=""> - Carregando - </option>');
            $.ajax({
                type: 'POST',
                url: '<?php echo $this->url(array('controller' => 'segmento', 'action' => 'combo')); ?>',
                data: {
                    id: $('#areaCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').val()
                },
                success: function(dados) {
                    $('#segmentoCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').find('option').remove();
                    $('#segmentoCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').append(dados);
                }
            });
        });

        $('#segmentoCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').html('<option value=""> - Carregando - </option>');
        $.ajax({
            type: 'POST',
            url: '<?php echo $this->url(array('controller' => 'segmento', 'action' => 'combo')); ?>',
            data: {
                id: $('#areaCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').val()
            },
            success: function(dados) {
                $('#segmentoCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').find('option').remove();
                $('#segmentoCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').append(dados);
                $('#segmentoCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?> option').each(function(){
                    if($(this).val() == '<?php echo $planoDistribuicao->idSegmento; ?>'){
                        $(this).attr('selected',true);
                    }
                });
            }
        });
        <?php endif; ?>

        $("#qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").keyup(function(){
            somaValores('qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'patrocinador-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'divulgacao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'beneficiarios-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            multiplicaValores('qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'preconormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
            somaValores('previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'totalprevisto-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
        });

        $("#qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").keyup(function(){
            somaValores('qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'patrocinador-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'divulgacao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'beneficiarios-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            multiplicaValores('qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'precopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
            somaValores('previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'totalprevisto-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
        });

        $("#patrocinador-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>,#divulgacao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>,#beneficiarios-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").keyup(function(){
            somaValores('qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'patrocinador-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'divulgacao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'beneficiarios-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
        });

        $("#preconormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").keyup(function(){
            multiplicaValores('qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'preconormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
            somaValores('previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'totalprevisto-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
        });

        $("#precopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").keyup(function(){
            multiplicaValores('qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'precopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
            somaValores('previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'totalprevisto-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
        });

        //===========================================================================================================

        $("#qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").blur(function(){
            somaValores('qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'patrocinador-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'divulgacao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'beneficiarios-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            multiplicaValores('qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'preconormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
            somaValores('previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'totalprevisto-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
        });

        $("#qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").blur(function(){
            somaValores('qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'patrocinador-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'divulgacao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'beneficiarios-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            multiplicaValores('qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'precopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
            somaValores('previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'totalprevisto-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
        });

        $("#patrocinador-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>,#divulgacao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>,#beneficiarios-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").blur(function(){
            somaValores('qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'patrocinador-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'divulgacao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
            somaValores('nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'beneficiarios-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 0, true);
        });

        $("#preconormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").blur(function(){
            multiplicaValores('qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'preconormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
            somaValores('previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'totalprevisto-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
        });

        $("#precopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").blur(function(){
            multiplicaValores('qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'precopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
            somaValores('previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 'totalprevisto-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>', 2, true);
        });
        
        $('#btn_salvar-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').click(function(){
            
            var i=0,
                erros = null,
                nExemplares = parseInt($('input#nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').val()),
                patrocinador = parseInt($('input#patrocinador-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').val()),
                divulgacao = parseInt($('input#divulgacao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').val()),
                baixarenda = parseInt($('input#beneficiarios-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').val()),
                qtdenormal = parseInt($('input#qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').val()),
                qtdepromocional = parseInt($('input#qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').val()),
                preconormal = parseInt($('input#preconormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').val().replace(/\./g, '').replace(',', '')),
                precopromocional = parseInt($('input#precopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>').val().replace(/\./g, '').replace(',', ''));
	    
            if( patrocinador > (nExemplares/10) ){
                i++;
                erros = erros + i+' - A quantidade destinada ao patrocinador n&atilde;o pode ser maior do que 10% do n&uacute;mero Exemplares/Ingressos.<br />';
            }
            if( divulgacao > (nExemplares/10) ){
                i++;
                erros = erros + i+' - A quantidade destinada &agrave; divulga&ccedil;&atilde;o n&atilde;o pode ser maior do que 10% do n&uacute;mero Exemplares/Ingressos.<br />';
            }
            if( baixarenda < (nExemplares/10) ){
                i++;
                erros = erros + i+' - A quantidade destinada &agrave; popula&ccedil;&atilde;o de baixa renda n&atilde;o pode ser menor do que 10% do n&uacute;mero Exemplares/Ingressos.<br />';
            }
            if( precopromocional > preconormal){
                i++;
                erros = erros + i+' - Valor normal n&atilde;o pode ser menor do que o valor promocional.<br />';
            }
            if( qtdenormal == null ){
                i++;
                erros = erros + i+' - Favor preencher o campo Normal(Qntd).<br />';
            }
            if( qtdepromocional == null ){
                i++;
                erros = erros + i+' - Favor preencher o campo Promocional(Qntd).<br />';
            }
            if( patrocinador==0 && divulgacao==0 && baixarenda==0 && qtdenormal==0 && qtdepromocional==0){
                i=0;
            }
            
            var preenchimento = true;
            $('.obrigatorio').each(function(){
                if($.trim($(this).val()) == ''){
                    preenchimento = false;
                }
            });
            
            if(!preenchimento){
                i++;
                erros = erros + i+' - Favor preencher os campos obrigatórios.';
            }
            
            if(i>0){
                $("#msgAlerta").dialog("destroy");
                $("#msgAlerta").html(erros);
                $("#msgAlerta").dialog({
                    resizable: false,
                    title: 'Alerta!',
                    width: 440,
                    modal: true,
                    buttons : {
                        'OK' : function(){
                            $(this).dialog('close');
                        }
                    }
                });
                $('.ui-dialog-titlebar-close').remove();
          } else {
                $("#frmPlanoDistribuicao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>").submit();
          }
                
        });
	    
	
	<?php endforeach; ?>
        
    });

    //SOMA VALORES NUMERICOS
    function somaValores(id1, id2, idDestino, precisao, tratarMascara){
        var cmp1 = $("#" + id1).val();
        var cmp2 = $("#" + id2).val();
        var valor1 = 0;
        var valor2 = 0;
        var soma_valores = 0;

        if(!cmp1){ cmp1 = "0"; }
        if(!cmp2){ cmp2 = "0"; }

        if(tratarMascara == true){
            valor1 = cmp1.replace(".","");
            valor1 = valor1.replace(",", ".");
            valor2 = cmp2.replace(".", "");
            valor2 = valor2.replace(",", ".");
        } else {
            valor1 = cmp1;
            valor2 = cmp2;
        }

        soma_valores = parseFloat(valor1) + parseFloat(valor2);
        soma_valores = Math.abs(soma_valores);
        soma_valores = soma_valores.toFixed(precisao);
        if (precisao == 0) {
            $('#' + idDestino).val(soma_valores);
        } else {
            $('#' + idDestino).val(soma_valores).priceFormat();
        }
    }

    //MULTIPLICA VALORES NUMERICOS
    function multiplicaValores(id1, id2, idDestino, precisao, tratarMascara){
        var cmp1 = $("#" + id1).val();
        var cmp2 = $("#" + id2).val();
        var valor1 = 0;
        var valor2 = 0;
        var soma_valores = 0;

        if(!cmp1){ cmp1 = "0"; }
        if(!cmp2){ cmp2 = "0"; }

        if(tratarMascara == true){
            valor1 = cmp1.replace(".","");
            valor1 = valor1.replace(",",".");
            valor2 = cmp2.replace(".","");
            valor2 = valor2.replace(",",".");
        }else{
            valor1 = cmp1;
            valor2 = cmp2;
        }

        soma_valores = parseFloat(valor1) * parseFloat(valor2);
        soma_valores = Math.abs(soma_valores);
        soma_valores = soma_valores.toFixed(precisao);
        $('#'+idDestino).val(soma_valores).priceFormat();
    }

    function mostraOcultaElemento(elemento)
    {
            $('.' + elemento).toggle();

            if ($('#' + elemento).hasClass('btn_adicionar'))
            {
                    $('#' + elemento).addClass('btn_remover');
                    $('#' + elemento).removeClass('btn_adicionar');
            }
            else
            {
                    $('#' + elemento).addClass('btn_adicionar');
                    $('#' + elemento).removeClass('btn_remover');
            }
    }

</script>

<style type="text/css">
    label.error{ color:red; font-weight: normal; }
</style>

<!-- ========== INICIO CONTEUDO ========== -->
<div id="confirma" class="sumir"></div>
<div id="msgAlerta" class="sumir"></div>

<div id="conteudo">
    <?php foreach($this->planoDistribuicao as $planoDistribuicao): ?>

        <table class="tabela">
            <tr>
                <td align="left">	
		    <input type="button" onclick="mostraOcultaElemento(<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>);" id="<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" class="btn_adicionar">
		    <?php echo "<strong>".$planoDistribuicao->Produto."</strong>";?> <?php if($planoDistribuicao->stPrincipal == 1) echo "<span style='color:red'>(produto principal)</span>";?></b>
                </td>
            </tr>
            <tr class="<?php echo $planoDistribuicao->idPlanoDistribuicao;?> sumir" align="left">
		<td>
		    <form action="<?php echo $this->url(array('controller' => 'alterarprojeto', 'action' => 'alterarplanodistribuicao')); ?>" name="frmPlanoDistribuicao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" id="frmPlanoDistribuicao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" method="post">
    <input type="hidden" name="idPlanoDistribuicao" id="idPlanoDistribuicao" value="<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>">
    <input type="hidden" name="idProjeto" id="idProjeto" value="<?php echo $planoDistribuicao->idProjeto; ?>">
    <input type="hidden" name="pronac" id="pronac" value="<?php echo $this->pronac; ?>">    
    <!-- ========== INÍCIO TABELA DADOS ========== -->
    <table  class="tabela">
        <tr>
            <th colspan="4" align="center">Nome do Evento / Produto</th>
        </tr>
        <tr>
            <td class="destacar bold" style="width: 1px;">&Aacute;rea <span style="color: red;">*</span></td>
            <td>
                <select class="input_simples obrigatorio" name="areaCultural" id="areaCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" value="<?php echo $planoDistribuicao->idArea; ?>">
                    <option value=""> - Selecione uma área cultural - </option>
                    <?php foreach ($this->comboareasculturais as $comboareacultural): ?>
                        <option value="<?php echo $comboareacultural->id; ?>" <?php echo ($comboareacultural->id == $planoDistribuicao->idArea) ? " selected='selected'" : ""; ?>>
                            <?php echo $comboareacultural->descricao; ?>
                        </option>
                    <?php endforeach; ?>
                </select>
            </td>
            <td class="destacar bold" style="width: 1px;">Segmento <span style="color: red;">*</span></td>
            <td>
                <select class="input_simples obrigatorio" name="segmentoCultural" id="segmentoCultural-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>">
                    <option value=""> <?php echo " - Selecione um segmento cultural - "; ?> </option>
                </select>
            </td>
        </tr>
    </table>

    <table class="tabela">
        <tr>
            <th align="center" colspan="3"><?php echo "Distribui&ccedil;&atilde;o Gratuita"; ?> (Qtde)</th>
        </tr>
        <tr>
            <td class="destacar bold" width="33%" align="center">Patrocinador</td>
            <td class="destacar bold" width="33%" align="center">Divulga&ccedil;&atilde;o</td>
            <td class="destacar bold" width="34%" align="center">Popula&ccedil;&atilde;o de Baixa Renda</td>
        </tr>
        <tr>
            <td align="center">
                <input class="input_simples" type="text" name="qtdPatrocinador" id="patrocinador-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" value="<?php echo $planoDistribuicao->QtdePatrocinador; ?>" maxlength="8" size="10">
            </td>
            <td align="center">
                <input class="input_simples" type="text" name="qtdDivulgacao" id="divulgacao-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" value="<?php echo $planoDistribuicao->QtdeProponente; ?>" maxlength="8" size="10">
            </td>
            <td align="center">
                <input class="input_simples" type="text" name="qtdBeneficiarios" id="beneficiarios-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" value="<?php echo $planoDistribuicao->QtdeOutros; ?>" maxlength="8" size="10">
            </td>
        </tr>
    </table>

    <table class="tabela">
        <tr>
            <th align="center" colspan="2">Total para a Venda (Qtde)</th>
            <th align="center">Quantidade</th>
        </tr>
        <tr>
            <td class="destacar bold" width="33%" align="center">Normal <span style="color: red;">*</span></td>
            <td class="destacar bold" width="33%" align="center">Promocional <span style="color: red;">*</span></td>
            <td class="destacar bold" width="34%" align="center">N&ordm; Exemplares / Ingressos</td>
        </tr>
        <tr>
            <td align="center">
                <input class="input_simples obrigatorio" type="text" name="qtdenormal" id="qtdenormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" value="<?php echo $planoDistribuicao->QtdeVendaNormal; ?>" maxlength="8" size="10">
            </td>
            <td align="center">
                <input class="input_simples obrigatorio" type="text" name="qtdepromocional" id="qtdepromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" value="<?php echo $planoDistribuicao->QtdeVendaPromocional; ?>" maxlength="8" size="10">
            </td>
            <td align="center">
                <input disabled="disabled"  name="nexemplares" id="nexemplares-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" class="input_simples" type="text" maxlength="10" value="<?php echo $planoDistribuicao->QtdeProduzida; ?>">
            </td>
        </tr>
    </table>

    <table class="tabela">
        <tr>
        <tr>
            <th align="center" colspan="2"><?php echo utf8_encode("Pre&ccedil;o Unit&aacute;rio (R$)"); ?></th>
            <th align="center" colspan="2">Receita Prevista (R$)</th>
            <th align="center">Total Receita Prevista (R$)</th>
        </tr>
        <tr>
            <td class="destacar bold" align="center">Normal <span style="color: red;">*</span></td>
            <td class="destacar bold" align="center">Promocional <span style="color: red;">*</span></td>
            <td class="destacar bold" align="center">Normal <span style="color: red;">*</span></td>
            <td class="destacar bold" align="center">Promocional <span style="color: red;">*</span></td>
            <td class="destacar bold" align="center">Total</td>
        </tr>
        <tr>  
            <td align="center">
                <input class="input_simples obrigatorio" type="text" name="preconormal" id="preconormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" value="<?php echo @number_format(($planoDistribuicao->PrecoUnitarioNormal), 2, ",", "."); ?>" maxlength="9" size="10">
            </td>
            <td align="center">
    <input class="input_simples obrigatorio" type="text" name="precopromocional" id="precopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" value="<?php echo @number_format(($planoDistribuicao->PrecoUnitarioPromocional), 2, ",", "."); ?>" maxlength="9" size="10">
            </td>
            <td align="center">
                <input   name="previstonormal"  disabled="disabled"  id="previstonormal-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" class="input_simples" type="text" maxlength="10" value="<?php echo number_format($planoDistribuicao->QtdeVendaNormal * $planoDistribuicao->PrecoUnitarioNormal, 2, ',', '.'); ?>" size="10">
            </td>
            <td align="center">
                <input class="input_simples"  disabled="disabled"  name="previstopromocional" id="previstopromocional-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" type="text" maxlength="10" value="<?php echo $planoDistribuicao->QtdeVendaPromocional * str_replace(",", ".", $planoDistribuicao->PrecoUnitarioPromocional); ?>" size="10">
            </td>
            <td align="center">
                <input disabled="disabled"  name="totalprevisto" id="totalprevisto-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" class="input_simples" type="text" maxlength="10" value="<?php echo number_format($planoDistribuicao->QtdeVendaNormal * $planoDistribuicao->PrecoUnitarioNormal + $planoDistribuicao->QtdeVendaPromocional * $planoDistribuicao->PrecoUnitarioPromocional, 2, ',', '.'); ?>">
            </td>
        </tr>
    </table>

    <div style="width: 100%">
        <!--<p align="center"><input type="submit" style="width: 88px" value="" class="btn_salvar" id="btn_salvar" /></p>-->
        <p align="center"><input type="button" value="" class="btn_salvar" id="btn_salvar-<?php echo $planoDistribuicao->idPlanoDistribuicao; ?>" /></p>
    </div>
    <br clear="all" />
		    </form>
		</td>
	</tr>
	</table>
		    
<?php endforeach; ?>
</div>
<!-- ========== INÍCIO RODAPÉ DO CONTEÚDO ========== -->
<div id="rodapeConteudo"><span></span></div>
<!-- ========== FIM RODAPÉ DO CONTEÚDO ========== -->

<br clear="all" />
